library(supc)
set.seed(1)
mu <- list(
  x = c(0, 2, 1, 6, 8, 7, 3, 5, 4),
  y = c(0, 0, 1, 0, 0, 1, 3, 3, 4)
)
X <- lapply(1:3, function(i) {
  cbind(rnorm(9, mu$x, 1/5), rnorm(9, mu$y, 1/5))
})
X <- do.call(rbind, X)
parameters <- list(tau = 0.9, t = function() {0.75})
X.supc <- supc1(X, parameters)

X.supc.ref <- structure(c(-0.0180254152334057, 2.04672713943872, 1.08716939781709,  6.2091141762813, 8.01477611109684, 6.79821207689805, 3.1200608974441,  5.08556992438095, 3.97988236813749, -0.0180254152300982, 2.04672713943925,  1.08716939784777, 6.20911417627775, 8.0147761102155, 6.79821207689747,  3.1200608974441, 5.08556992437818, 3.97988236810211, -0.0180254152332781,  2.04672713943902, 1.08716939784812, 6.20911417628073, 8.01477611012977,  6.79821207689811, 3.1200608974441, 5.085569924381, 3.97988236809601,  -0.162390279740863, 0.0922984238523386, 1.10583358958224, 0.0381059301279039,  -0.0860889800969263, 1.12872658834521, 2.95353852156743, 2.93593224005234,  3.9557877283525, -0.162390279743319, 0.0922984238494918, 1.10583358958586,  0.0381059301389982, -0.0860889742142012, 1.12872658834511, 2.95353852156743,  2.93593224004611, 3.95578772829312, -0.162390279740958, 0.0922984238506452,  1.1058335895859, 0.0381059301296217, -0.0860889736438826, 1.12872658834522,  2.95353852156743, 2.93593224005244, 3.9557877282829), .Dim = c(27L,  2L), .Dimnames = list(c("1", "2", "3", "4", "5", "6", "7", "8",  "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19",  "20", "21", "22", "23", "24", "25", "26", "27"), NULL))

stopifnot(isTRUE(all.equal(X.supc, X.supc.ref)))

result <- lapply(split(1:27, 1:9), function(i) {
  X.part <- X.supc[i,]
  list(center = colMeans(X.part), withinss = max(dist(X.part)))
})
result.center <- sapply(result, "[[", "center")
result.withinss <- sapply(result, "[[", "withinss")
stopifnot(min(dist(t(result.center))) / max(result.withinss) > 1e4)
